<div id="image03" style="display: inline_block" align="center">
		<img src="assets/logo.png"/>
		</div>

</div>




<h1 align="center"> Sum√°rio üìñ </h1>
<div id="sumario" style="display: inline_block" align="center">
	<a href="#intro"> Introdu√ß√£o  </a> |
	<a href="#conceitos"> Conceitos & Metodologia </a> |
	<a href="#docker"> Docker </a> |
	<a href="#conclusao"> Conclus√£o </a>
</div>
<br>

<div id="intro">

# Introdu√ß√£o üéâ

A efici√™ncia no fornecimento de energia el√©trica √© essencial para uma cidade inteligente e sustent√°vel. Visando oferecer um servi√ßo de qualidade para a popula√ß√£o, a prefeitura de uma cidade resolveu adotar uma infraestrutura de IoT para monitorar o consumo de energia el√©trica em tempo real e promover o uso consciente dos recursos.

Para atingir esse objetivo, a prefeitura e a concession√°ria de abastecimento lan√ßaram um edital que busca empreendedores de tecnologia especializados em IoT para apresentar solu√ß√µes que permitam a coleta e an√°lise dos dados de consumo de energia el√©trica em larga escala.

Nesse contexto, nossa startup foi convidada a apresentar um prot√≥tipo que utiliza tecnologias de IoT para coletar, processar e apresentar os dados de consumo de energia el√©trica de forma simples e acess√≠vel. Nosso sistema permitir√° que cada cliente tenha um controle mais preciso sobre seu consumo de energia el√©trica, podendo monitor√°-lo em tempo real e identificar poss√≠veis gargalos que gerem desperd√≠cios e gastos excessivos.

Neste relat√≥rio, apresentaremos um prot√≥tipo desenvolvido por uma startup fict√≠cia que visa solucionar o problema proposto pela prefeitura. O prot√≥tipo consiste em um sistema de coleta de dados automatizado, que permite a gera√ß√£o de informa√ß√µes precisas sobre o consumo de energia em resid√™ncias, o c√°lculo da fatura a ser paga e o envio de alertas aos usu√°rios em caso de consumo excessivo ou varia√ß√£o na conta. Al√©m disso, a solu√ß√£o envolve um servidor soquete que ir√° receber dados dos medidores inteligentes instalados nas resid√™ncias dos usu√°rios, e ser√° poss√≠vel visualizar esses dados de forma online atrav√©s de uma interface web que consome uma API REST.

Ao longo deste relat√≥rio, detalharemos a arquitetura do sistema, as tecnologias utilizadas, os resultados obtidos e as poss√≠veis melhorias para o futuro. Esperamos que este relat√≥rio seja √∫til para outras empresas e prefeituras que desejam incorporar a loT em seus servi√ßos e tornar suas cidades mais inteligentes.

Vamos juntos nessa jornada em busca de uma cidade mais inteligente e sustent√°vel! üí°üåç
</div>

<div id="conceitos">

# Conceitos & Metodologia üìö

O c√≥digo desenvolvido √© dividido em tr√™s grandes partes: a primeira parte √© o medidor, que funciona como o cliente e √© respons√°vel por enviar os dados de consumo de energia para o servidor. A segunda parte √© o servidor, que armazena todos os dados enviados pelos medidores via soquete. E a terceira parte √© o usu√°rio online, onde foi criada uma interface web usando React para visualizar os dados de consumo de energia em tempo real.

Os conceitos que abrangem o problema principal do projeto s√£o: o uso de soquetes para comunica√ß√£o entre dispositivos diferentes, API REST, que permite levar esses dados para o cliente atrav√©s do protocolo HTTP, o uso de threads e outras formas para acompanhar m√∫ltiplas conex√µes, e o Docker para containeriza√ß√£o do projeto, garantindo que o ambiente de desenvolvimento e de produ√ß√£o sejam iguais, facilitando a implanta√ß√£o do sistema.

Esses conceitos ser√£o mais discutidos durante as 3 partes que comp√µe a aplica√ß√£o, assim como sua metodologia.

<lu>
    <li><a href="#client">Client</a></li>
    <li><a href="#server">Server</a></li>
    <li><a href="#user">User</a></li>
</lu>
</div>

<br>

<div id="client">  
  
# Measurer (Cliente/Medidor) üì±

## Funcionalidades üöÄ

O cliente tem as seguintes funcionalidades:

- Envia dados de consumo de energia el√©trica para um servidor
- Permite ao usu√°rio configurar a taxa de consumo de energia el√©trica

## Bibliotecas utilizadas üìö

Para implementar o cliente, foram utilizadas as seguintes bibliotecas Python:

- `socket`: para criar e configurar o socket de rede
- `json`: para serializar os dados em formato JSON
- `datetime`: para gerar a data e hora atuais
- `time`: para controlar o tempo de envio de dados
- `threading`: para executar o envio de dados e a configura√ß√£o de taxa de consumo em threads separadas

## Como executar üõ†Ô∏è

Para executar o cliente, √© necess√°rio executar o arquivo client.py.

```console
python measurer.py
```

## Como usar üìù

1. Clone este reposit√≥rio em sua m√°quina local.
2. Certifique-se de que os requisitos estejam instalados.
3. Execute o servidor primeiro.
4. Em seguida, execute o arquivo measurer.py.
5. Siga as instru√ß√µes do menu para alterar a taxa de consumo ou sair do programa.

O cliente est√° configurado para enviar dados para o servidor com endere√ßo IP "172.16.103.2" e porta 4005. Para configurar a taxa de consumo de energia el√©trica, siga as op√ß√µes exibidas no menu. Para sair do programa, escolha a op√ß√£o "4".

## Como funciona üìù

O cliente √© respons√°vel por enviar dados do consumo de energia el√©trica para o servidor atrav√©s de uma conex√£o socket TCP/IP. Ele √© desenvolvido em Python e utiliza a biblioteca socket para realizar a comunica√ß√£o com o servidor. O cliente √© iniciado a partir da execu√ß√£o do arquivo measurer.py.

O c√≥digo do cliente √© dividido em duas principais fun√ß√µes:

### Fun√ß√£o get_id()
Essa fun√ß√£o √© respons√°vel por solicitar ao servidor um ID para o medidor de consumo de energia el√©trica. Ela envia uma mensagem JSON contendo o valor 0 para o servidor e aguarda a resposta com o ID, que √© armazenado na vari√°vel id.

### Fun√ß√£o send_data()
Essa fun√ß√£o √© respons√°vel por enviar para o servidor os dados de consumo de energia el√©trica em tempo real. Ela envia uma mensagem JSON contendo o ID do medidor, o valor do consumo, a data e hora do consumo e o tipo de mensagem. A vari√°vel rate √© utilizada para simular o consumo em tempo real, e a vari√°vel spent √© utilizada para armazenar o total consumido pelo medidor.

Al√©m dessas fun√ß√µes, o c√≥digo do cliente tamb√©m possui uma fun√ß√£o menu() que permite ao usu√°rio alterar a taxa de consumo do medidor. Essa fun√ß√£o √© executada em uma thread separada, e permite que o usu√°rio aumente, diminua ou defina uma nova taxa de consumo. A thread principal do cliente √© respons√°vel por enviar os dados de consumo em tempo real.

Ao final da execu√ß√£o, o cliente √© encerrado e a conex√£o com o servidor √© fechada.

</div>

<div id="server">

# Server (API REST) üñ•Ô∏èüåê

## Funcionalidades üöÄ
O servidor tem as seguintes funcionalidades:

- Recebe requisi√ß√µes HTTP GET e POST
- Interpreta as requisi√ß√µes e envia a resposta adequada para cada uma delas
- Armazena os dados das requisi√ß√µes POST para uso posterior

## Bibliotecas utilizadas üìö

Para implementar o servidor, foram utilizadas as seguintes bibliotecas Python:

- `socket`: para criar e configurar o socket de rede
- `selectors`: para gerenciar eventos de I/O de forma eficiente
- `types`: para definir os tipos dos objetos utilizados pelo programa
- `json`: para serializar os dados em formato JSON

## Como executar üõ†Ô∏è
Para executar o servidor, √© necess√°rio executar o arquivo initialize.py e estar no mesmo diret√≥rio do arquivo.

```console
python initialize.py
```
## Como funciona üìù

O c√≥digo apresentado √© um servidor web simples que pode lidar com as solicita√ß√µes GET e POST enviadas por um cliente. Ele utiliza a biblioteca selectors para suportar opera√ß√µes de I/O multiplexadas, permitindo que o servidor possa lidar com v√°rias conex√µes de forma eficiente.

Inicialmente, o servidor cria um objeto DefaultSelector() da biblioteca selectors que ser√° respons√°vel por gerenciar as opera√ß√µes de I/O das conex√µes. Em seguida, ele define um endere√ßo IP e porta para a conex√£o do socket e cria um socket de escuta com o m√©todo socket(). O socket de escuta aguarda a conex√£o de novos clientes.

O m√©todo register() √© utilizado para registrar um socket com o seletor de E/S, especificando o evento a ser monitorado (EVENT_READ para leitura ou EVENT_WRITE para escrita), bem como os dados adicionais que ser√£o associados ao socket.

O m√©todo accept_wrapper() √© chamado sempre que uma nova conex√£o √© aceita pelo servidor. Ele extrai a conex√£o e o endere√ßo do cliente e registra o socket com o seletor de E/S, especificando os eventos a serem monitorados.

O m√©todo service_connection() √© respons√°vel por processar as solicita√ß√µes recebidas de cada conex√£o registrada. Ele verifica se h√° dados a serem lidos e, se sim, os armazena em um buffer. Em seguida, ele chama a fun√ß√£o type_mensage() para analisar a solicita√ß√£o recebida e determinar se ela √© uma solicita√ß√£o GET, POST ou outro tipo de solicita√ß√£o. Dependendo do tipo de solicita√ß√£o, o m√©todo service_connection() pode chamar as fun√ß√µes get() ou post() para processar os dados e gerar uma resposta. Se houver dados a serem escritos, o m√©todo service_connection() envia a resposta para o cliente. Se a solicita√ß√£o n√£o puder ser processada, o m√©todo type_mensage() retorna um erro.

O servidor continua a executar em um loop infinito, aguardando novas conex√µes e processando as solicita√ß√µes recebidas. O loop √© interrompido somente se o programa for interrompido por um sinal de teclado (KeyboardInterrupt). Quando o loop √© interrompido, o servidor √© encerrado e o seletor de E/S √© fechado com o m√©todo close().

</div>

<div id ="user">

# User (Frontend) üë§üíª

Este √© um projeto para construir um frontend para um sistema de medi√ß√£o de consumo de energia el√©trica. O frontend foi constru√≠do utilizando React, Tailwind CSS e TypeScript, com a configura√ß√£o do ambiente utilizando Vite. Para criar a interface, foram utilizadas as bibliotecas de UI Radix UI e Material UI. O consumo de dados √© feito atrav√©s do Axios, que consome a API previamente desenvolvida.

## Funcionalidades üöÄ
O frontend tem as seguintes funcionalidades:

- Tela de login na rota "/signin"
- Ap√≥s inserir o ID v√°lido, o cliente √© redirecionado para a p√°gina de hist√≥rico, que mostra o hist√≥rico de consumo atual e gr√°ficos relacionados a ele
- Na tela de hist√≥rico, √© poss√≠vel ir para a tela de fatura (invoice), que cont√©m o valor atual da fatura e algumas informa√ß√µes, juntamente com o QRCode da fatura.

## Bibliotecas utilizadas üìö
Para implementar o frontend, foram utilizadas as seguintes bibliotecas:

- React: para a cria√ß√£o de componentes reutiliz√°veis
- Tailwind CSS: para a estiliza√ß√£o da interface
- TypeScript: para o desenvolvimento de c√≥digo mais seguro e com maior integridade
- Vite: para a configura√ß√£o do ambiente de desenvolvimento
- Axios: para o consumo da API previamente desenvolvida
- Radix UI: para a cria√ß√£o de componentes de interface personalizados
- Material UI: para a utiliza√ß√£o de √≠cones e componentes predefinidos

## Como executar üõ†Ô∏è
Para executar o frontend, primeiro deve se  atentar a ter j√° seu server e alguns clientes rodando para uma melhor visualiza√ß√£o da interface, al√©m de evitar erros. Dito isso, √© necess√°rio  executar o seguinte comando:

```console
npm install
npm run dev
```

## Como Funciona üìù

Como n√£o foi solicitado uma interface web para o cliente, n√£o entraremos em muitos detalhes de como foi feito. No entanto, √© poss√≠vel utilizar as telas de login, hist√≥rico e fatura do sistema atrav√©s das rotas "/signin", "/history" e "/invoice", respectivamente. Para acessar a tela de fatura, √© necess√°rio ter inserido um ID v√°lido na tela de login.

<br>

<div id="image01" style="display: inline_block" align="center">
		<img src="assets/login.png"/>
		<p>
			Tela de Login
			</p>
		</div>

</div>

<div id="image02" style="display: inline_block" align="center">
		<img src="assets/historic.png"/>
		<p>
			Tela de Hist√≥rico
			</p>
		</div>

</div>

<div id="image03" style="display: inline_block" align="center">
		<img src="assets/invoice.png"/>
		<p>
			Tela de Fatura
			</p>
		</div>

</div>

<div id="docker">

# Docker üê≥



</div>

<div id ="conclusao">

# Conclus√£o üèÅ

Com base no projeto desenvolvido, foi poss√≠vel implementar um sistema de medi√ß√£o de energia el√©trica em Python. O projeto foi dividido em duas partes principais: o backend e o frontend. No backend, foi implementado um servidor que recebe os dados de consumo de energia el√©trica enviados pelos clientes. Foi utilizado o protocolo TCP/IP para a comunica√ß√£o entre os clientes e o servidor, e a biblioteca Socket do Python foi utilizada para implementar o servidor.

No frontend, foi desenvolvido um cliente que envia os dados de consumo de energia el√©trica para o servidor. O cliente foi implementado utilizando a biblioteca Socket do Python para criar e configurar o socket de rede, a biblioteca JSON para serializar os dados em formato JSON, a biblioteca Datetime para gerar a data e hora atuais, e a biblioteca Threading para executar o envio de dados e a configura√ß√£o de taxa de consumo em threads separadas. O cliente permite ao usu√°rio configurar a taxa de consumo de energia el√©trica e enviar os dados para o servidor.

Al√©m disso, foi desenvolvido um frontend em React, Tailwind CSS e Typescript, utilizando as bibliotecas Radix UI e Material UI para os componentes de interface do usu√°rio. O frontend possui tr√™s principais p√°ginas: a p√°gina de login, a p√°gina de hist√≥rico e a p√°gina de fatura. Na p√°gina de login, o usu√°rio insere seu ID de cadastro v√°lido e √© redirecionado para a p√°gina de hist√≥rico, que mostra o hist√≥rico de consumo atual e gr√°ficos relacionados a ele. Nessa p√°gina, o usu√°rio pode ir para a p√°gina de fatura, que mostra o valor atual da fatura e algumas informa√ß√µes juntamente com o QRCode da fatura.

O projeto foi um sucesso, e todas as funcionalidades propostas foram implementadas com sucesso. A entrega do projeto foi feita dentro do prazo estipulado e com alta qualidade. O resultado final foi um sistema de medi√ß√£o de energia el√©trica robusto e funcional, que atende √†s necessidades dos usu√°rios de forma eficiente e f√°cil de usar.

</div>